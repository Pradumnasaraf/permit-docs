---
sidebar_position: 4
title: Run Local Authorization Microservice
timeline: true
---

Running a local **authorization microservice** ([PDP](/overview/glossary#pdp)) provides significant benefits for your application's performance, security, and reliability. This guide will help you understand and set up local authorization in your application.

import CodeBlock from "../../src/components/code-block/CodeBlock";
import WhatsNext from "../../src/components/whats-next/WhatsNext";
import TimelineStep from "../../src/components/timeline/TimelineStep";
import TimelineWrapper from "../../src/components/timeline/TimelineWrapper";
import Video from "../../src/components/video/Video";

import pullPDP from "/img/updated/walkthroughs/local-policy-check/pulling-pdp.mp4";
import runPDP from "/img/updated/walkthroughs/local-policy-check/running-pdp.mp4";

## Why Run Authorization Locally?

Running authorization locally through a **Policy Decision Point** (PDP) offers several key advantages:

### 1. Lightning-Fast Performance

- **Zero Network Latency**: All authorization decisions are made **locally** within your infrastructure, eliminating network delays
- **High Throughput**: Process thousands of authorization requests per second with **sub-millisecond latency**
- **Optimized Response Times**: Critical for user-facing applications where every millisecond counts
- **Reduced API Calls**: Minimize external API calls by processing decisions locally

### 2. Enhanced Security

- **Data Privacy**: Sensitive data never leaves your infrastructure, perfect for [compliance-focused organizations](/concepts/compliance)
- **Compliance**: Easier adherence to data residency requirements ([GDPR](/concepts/compliance#gdpr), [HIPAA](/concepts/compliance#hipaa), etc.)
- **Controlled Access**: Full control over your authorization layer with detailed [audit logs](/how-to/audit/overview)
- **Secure Communication**: Encrypted communication between your application and the local PDP

### 3. Improved Reliability

- **Always Available**: Works even if cloud services are down, ensuring business continuity
- **Independent Operation**: No dependency on external services for critical authorization decisions
- **Local Control**: Full control over your authorization infrastructure and [scaling](/concepts/pdp/scaling)
- **Fault Tolerance**: Built-in failover capabilities for high availability

### 4. Advanced Policy Support

- **[RBAC](/how-to/build-policies/rbac/overview)**, **[ABAC](/how-to/build-policies/abac/overview)**, & **[ReBAC](/how-to/build-policies/rebac/overview)**: Support for all policy types in a single deployment
- **Complex Rules**: Handle sophisticated authorization scenarios with [custom rules](/how-to/build-policies/policy-rules)
- **Real-time Updates**: Policy changes are instantly reflected across your application
- **Flexible Configuration**: Customize the PDP to match your specific needs

# Running the Authorization Microservice

<TimelineWrapper>
<TimelineStep>

## Pull the Docker Container

First, pull the latest **PDP container** from Docker Hub:

```bash
docker pull permitio/pdp-v2:latest
```

<Video src={pullPDP} controls />

:::note
If you haven't installed Docker yet, [get it here](https://docs.docker.com/get-started/get-docker/).
:::

</TimelineStep>
<TimelineStep>

## Run the Container

Launch the PDP container with your [API key](/overview/use-the-permit-api-and-sdk):

```bash
docker run -it -p 7766:7000 \
  --env PDP_DEBUG=True \
  --env PDP_API_KEY=<YOUR_API_KEY> \
  permitio/pdp-v2:latest
```

<Video src={runPDP} controls />

<br />

The container will expose the PDP on `localhost:7766`, ready to handle authorization requests.

:::tip
You can verify the container is running and check its status with:

```bash
docker ps
docker logs <container_id>
```

:::

</TimelineStep>
<TimelineStep>

## Advanced Configuration Options

### Debug Mode

Enable detailed **logging** for troubleshooting:

```bash
docker run -it -p 7766:7000 \
  --env PDP_DEBUG=True \
  --env PDP_API_KEY=<YOUR_API_KEY> \
  --env PDP_OPA_DECISION_LOG_CONSOLE=True \
  permitio/pdp-v2:latest
```

This configuration provides:

- Detailed [decision logs](/how-to/audit/decision-logs)
- Performance metrics
- Error tracking
- Policy evaluation details

### Custom Port Configuration

Change the default port (7766) to match your infrastructure:

```bash
docker run -it -p 8000:7000 \
  --env PDP_API_KEY=<YOUR_API_KEY> \
  permitio/pdp-v2:latest
```

### Decision Log Settings

Fine-tune [logging behavior](/how-to/audit/decision-logs#configuration) for your needs:

```bash
docker run -it -p 7766:7000 \
  --env PDP_API_KEY=<YOUR_API_KEY> \
  --env PDP_OPA_DECISION_LOG_ENABLED=True \
  --env PDP_OPA_DECISION_LOG_MIN_DELAY=1 \
  permitio/pdp-v2:latest
```

</TimelineStep>
</TimelineWrapper>

## Monitoring and Debugging

Effective **monitoring** and **debugging** are crucial for maintaining a healthy authorization system. The local PDP provides several endpoints that help you track its [performance](/concepts/pdp/performance), ensure proper operation, and troubleshoot any issues that may arise. Let's explore the key monitoring tools at your disposal:

### Health Checks

Monitor your PDP's **health status**:

```
http://localhost:7766/health
```

The health endpoint provides:

- **Container status**: Current state of your PDP container
- **Policy sync status**: Real-time policy synchronization state
- **Connection health**: Network connectivity status
- **Resource utilization**: System resource usage metrics

### Metrics

Access detailed **performance metrics** via [Prometheus](/how-to/monitor/prometheus):

```
http://localhost:7766/metrics
```

Available metrics include:

- **Request latency**: Response time measurements
- **Decision counts**: Authorization decision statistics
- **Cache hit rates**: Policy cache effectiveness
- **Error rates**: Failed request tracking

### API Documentation

View the complete [PDP API](/api/pdp) documentation:

```
http://localhost:7766/redoc
```

The documentation covers:

- All available **endpoints**
- Request/response **formats**
- **Authentication** methods
- **Error handling** procedures

## What did you learn?

From this walkthrough, you've learned:

- How to set up and run a local **authorization microservice**
- Configure advanced **PDP options** for your specific needs
- Monitor and debug your **authorization layer**
- Access detailed **metrics** and health information

:::tip FUN FACT!
A well-configured local PDP can handle **thousands** of authorization decisions per second with **sub-millisecond latency**, making it perfect for high-performance applications. Some of our customers process **millions** of decisions daily with a single PDP instance!
:::

<WhatsNext progress={50} customText="Great job! You're now running local authorization.">
  <h2>What's next? ðŸŽ‰</h2>
  <ul>
    <li>Create user and resource attributes</li>
    <li>Define your first User and Resource Sets</li>
    <li>Create your ABAC policy rules</li>
  </ul>
</WhatsNext>
