---
sidebar_position: 6
title: Create a ReBAC Policy
---

import WhatsNext from "../../src/components/whats-next/WhatsNext";
import TimelineStep from "../../src/components/timeline/TimelineStep";
import TimelineWrapper from "../../src/components/timeline/TimelineWrapper";
import Video from "../../src/components/video/Video";

Setting up Relationship-Based Access Control (ReBAC) policies may seem complex, but with Permit, it’s a simple and intuitive
process. This step-by-step guide will walk you through configuring and enforcing ReBAC policies using the Permit dashboard.

:::info Before You Begin
This guide assumes you have already set up your Permit account and have a foundational understanding of ReBAC and the basics
of how Permit operates.
:::

## Defining our ReBAC Policy

In this guide, we’ll create ReBAC permissions for a dashboarding system. Below are the key aspects of the policy we’ll configure:

### Resource Hierarchy

- There are two types of resources: `Dashboard` and `Widget`.
- A Dashboard serves as the `parent` resource for `Widget`.

### Explicit permissions

Users can be assigned specific roles for `Dashboard` and `Widget` instances:

- `Owner`
- `Viewer`
- `Analyst/Editor`

Each role will come with it's own set of permissions.

### Implicit permissions

Users who have access to a `Dashboard` automatically inherit permissions for any `Widget` associated with that Dashboard.

## Configure policies

<TimelineWrapper>
<TimelineStep>

### Create Resources and Roles

The foundation of any ReBAC policy begins with defining your resources and their associated resource roles. Here’s how to set
them up using the Permit dashboard.

Start by navigating to the Resources section in the Permit dashboard - `Policy > Resources`. Once there, locate the `Add Resource`
button to begin creating your first resource. For this example, we’ll define two resources: `Dashboard` and `Widget`, each with
specific actions and resource roles.

<img
  src="/ui-videos/walkthroughs/rebac/resources-empty.png"
  alt="Empty Resource Screen"
  data-zoomable
/>

### Creating the Dashboard Resource

Click on Add Resource and enter the following details for the new resource:

- **Name**: `Dashboard`
- **Actions**: `view`, `remove-widget`, `add-widget`, `edit`, `delete`, `create`
- **Roles on resource**: `Owner`, `Viewer`, `Analyst`

<img
  src="/ui-videos/walkthroughs/rebac/dashboard-resource.png"
  alt="Dashboard Resource"
  data-zoomable
/>

After filling in the information, save the resource. At this point, you’ve successfully created the `Dashboard` resource,
which will serve as a parent resource in your system.

### Creating the Widget Resource

Next, click `Add Resource` again and provide the following details:

- **Name**: `Widget`
- **Actions**: `view`, `edit`, `delete`, `create`
- **Roles on resource**: `Owner`, `Viewer`, `Editor`

<img src="/ui-videos/walkthroughs/rebac/widget-resource.png" alt="Widget Resource" data-zoomable />

Save this resource once all the fields are complete. Now, the `Widget` resource is configured and will function as a child
resource tied to the Dashboard.

### Resources Overview

With these steps completed, you now have two resources defined in your ReBAC policy:

Dashboard, with its actions and roles.
Widget, with its distinct set of actions and roles.

<img src="/ui-videos/walkthroughs/rebac/resources.png" alt="Dashboard Resource" data-zoomable />

</TimelineStep>
<TimelineStep>

## Define resource relations

Now that the resources are created, the next step is to define how they relate to each other. Relationships are foundational to
structuring your ReBAC policy, enabling more granular control over access permissions by connecting resources in a meaningful
hierarchy. These relationships will later be instantiated as specific relationships or relationship-tuples between
individual resource instances.

### Configuring Relationships in the Permit Dashboard

#### 1. Open the Resource Editor

In the Resources section, locate the Dashboard resource. Click the three-dot menu icon next to it and select Edit.

<img src="/ui-videos/walkthroughs/rebac/edit-resource.png" alt="Edit Resource" data-zoomable />

#### 2. Define the Parent-Child Relationship

Navigate to the Relations section of the resource editor. Configure the Dashboard resource as the parent of the Widget resource.
This setup ensures that the Dashboard can act as a container for its associated Widget resources.

<img
  src="/ui-videos/walkthroughs/rebac/resource-relations.png"
  alt="Resource Relations"
  data-zoomable
/>

:::note
A resource cannot be its own parent. If a resource requires a self-relation, consider using an alternative relation type such as
owner or container.
:::

#### 3. Save the Relationship

Once the relationship is defined, save the configuration. You now have a clear hierarchical relationship where Dashboard
resources are parents to Widget resources.

### Why Relationships are Important

Defining relationships serves several critical purposes:

- **Inheritance of Permissions**: A parent-child relationship allows permissions to cascade. For example, if a user has access to a Dashboard, they can inherit specific permissions for its associated Widget resources.
- **Simplified Management**: Relationships reduce redundancy, enabling scalable and maintainable policies for complex systems.
- **Flexible Use Cases**: These relationships can adapt to real-world scenarios, such as granting access based on ownership, containment, or other resource-specific connections.

### Instantiating Relationships

Once defined, relationships between resources are instantiated as relationship-tuples, which represent connections between
specific resource instances.

For example:

- `User X` has a relationship of `Owner` with `Dashboard A`.
- `Dashboard A` is the `Parent` of `Widget B`.

These tuples allow your system to enforce access control dynamically based on real-time connections between instances.

By setting up these relationships, you’re creating a robust framework for managing permissions efficiently and effectively.

:::info
Once you successfully define the relationships on the roles - it will automatically create the roles for you in the policy
editor.
:::

</TimelineStep>
<TimelineStep>

## Define role derivations

With relationships defined, the next step in building a robust ReBAC system is configuring role derivations. Role derivation
allows roles to be dynamically assigned or inherited based on specific relationships, ensuring that permissions adapt to
real-world scenarios without requiring excessive manual intervention.

### Configuring Role Derivations

#### 1. Navigate to the Resource’s Role Derivation Settings

In the Permit dashboard, go to `Policy > Roles` where you should now see all `Resource Roles`.

<img src="/ui-videos/walkthroughs/rebac/roles-screen.png" alt="Roles Screen" data-zoomable />

#### 2. Define Role Derivation Logic

Within the Role Derivation section, establish the rules for how roles are inherited or assigned:

- For the Widget resource, set rules that derive roles from its parent Dashboard resource.
  Example configurations:

  - If a user is an `Owner` of a `Dashboard`, they automatically become an `Owner` of `all Widget instances` under that Dashboard.

    <img
      src="/ui-videos/walkthroughs/rebac/dashboard-derivations.png"
      alt="Dashboard Derivations"
      data-zoomable
    />

  - If a user is a `Viewer` of a `Dashboard`, they inherit the `Viewer` role for `all its Widget instances`.

    <img
      src="/ui-videos/walkthroughs/rebac/dashboard-viewer-derivations.png"
      alt="Dashboard Viewer Derivations"
      data-zoomable
    />

#### 3. Save the Role Derivation Rules

Once the derivation logic is defined, save the changes to apply the configuration.

At this stage, you have configured role derivations to dynamically assign roles based on the relationships between resources.
This configuration ensures a scalable, flexible ReBAC system capable of adapting to complex permission requirements.

<img
  src="/ui-videos/walkthroughs/rebac/dashboard-derivation-2.png"
  alt="Dashboard Derivation Summary"
  data-zoomable
/>

<img
  src="/ui-videos/walkthroughs/rebac/dashboard-viewer-derivation-2.png"
  alt="Dashboard Viewer Derivation Summary"
  data-zoomable
/>

</TimelineStep>
<TimelineStep>

## Configure permissions

With resources, relationships, and role derivations in place, the next step is to configure permissions. Permissions define the
actions users can perform based on their assigned or derived roles, ensuring that access control is implemented effectively.

For each role, assign the actions that the role can perform on the particular resource resource.
For this, navigate to `Policy`.

### For the Dashboard resource:

- **Owner**: Can `view`, `create`, `edit`, `delete`, `add-widget`, and `remove-widget`.
- **Viewer**: Can `view` only.
- **Analyst**: Can `view`, `add-widget`, and `edit`.

  <img
    src="/ui-videos/walkthroughs/rebac/dashboard-permissions.png"
    alt="Dashboard Permissions"
    data-zoomable
  />

### For the Widget resource:

- **Owner**: Can `view`, `create`, `edit`, and `delete`.
- **Viewer**: Can only `view`.
- **Editor**: Can `view` and `edit`.

  <img
    src="/ui-videos/walkthroughs/rebac/widget-permissions.png"
    alt="Widget Permissions"
    data-zoomable
  />

Once you assigned and saved your permissions, it's now time to test our policy and make sure it works.

</TimelineStep>
</TimelineWrapper>

## Test the Policy

<TimelineWrapper>
<TimelineStep>

## Create Users

</TimelineStep>
<TimelineStep>

## Create Resources

</TimelineStep>
<TimelineStep>

## Create Relationships

</TimelineStep>
<TimelineStep>

## Assign Roles

</TimelineStep>
<TimelineStep>

## Test the Policy

</TimelineStep>
</TimelineWrapper>
