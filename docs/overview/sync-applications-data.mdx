---
sidebar_position: 7
title: Sync Data into your App
---

import userAttributes from "../../static/ui-videos/walkthroughs/sync-data/user-attribute.mp4";

import WhatsNext from "../../src/components/whats-next/WhatsNext";
import TimelineStep from "../../src/components/timeline/TimelineStep";
import TimelineWrapper from "../../src/components/timeline/TimelineWrapper";
import Video from "../../src/components/video/Video";
import CodeBlock from "../../src/components/code-block/CodeBlock";

Policy decisions are often **driven by data**. While you can pass data in the check arguments, some of it would be **synced
to Permit in advance**. This guide will walk you through the data entities and how to sync them to Permit.

## Before we start: Understand Permit Data

These are the available data structures you might want to sync to Permit. These include:

- **users/attributes** (`ABAC`)
- **tenants/attributes** (`ABAC` & `ReBAC`)
- **role assignments** (`RBAC` & `ReBAC`)
- **resource instances/attributes** (`ABAC` & `ReBAC`)
- **resource relationship tuples** (`ReBAC`)

:::info
It's crucial to understand that most permissions rely heavily on additional data to function effectively.

Permit also supports event-driven sync of your data using OPAL scopes. You can read more about
it [here](https://deploy-preview-484--permitio-docs.netlify.app/how-to/manage-data/use-external-data-source).
:::

:::note
Permit Application Data can be added manually by using the Permit UI and via the API. We will be showing how to work with both
methods, if possible.
:::

<TimelineWrapper>
<TimelineStep>

## Users & User Attributes (ABAC)

You can send user attributes programmatically using the Permit API. This is especially useful for bulk operations or
integrating attribute management into your existing systems.

To add user attributes, you can use the following endpoint that `Creates a User`:

```bash
/v2/facts/{proj_id}/{env_id}/users
```

Replace `{proj_id}` and `{env_id}` with your project and environment identifiers.
As part of the data, you can pass in `attributes` for that particular unique user identity. Hereâ€™s an example using cURL to
send user attributes:

```bash
{
  "first_name": "Jane",
  "last_name": "Doe",
  "attributes": {
    "department": "marketing",
    "age": 30,
    "subscription": {
      "tier": "pro",
      "expired": false
    }
  }
}
```

:::tip VIA THE UI
Attributes can be added using our no-code dashboard to each individual user identity by navigating to the `Directory`, selecting
the user you want to add attributes to, clicking the `three dots` and selecting `Edit Attributes`.

<Video src={userAttributes} controls autoPlay={false} />
:::

</TimelineStep>
<TimelineStep>

## Tenants & Tenant Attributes (ABAC and ReBAC)

Tenant attributes describe properties or characteristics of a tenant, which typically represents a group, organization, or
account within a multi-tenant system. These attributes help differentiate tenants and apply access control policies based on
their specific requirements.

For example:

- **Region**: Defines the geographical location of the tenant, such as North America, Europe, or Asia.
- **Subscription Level**: Specifies the service tier, such as Basic, Pro, or Enterprise.
- **Industry**: Indicates the tenant's sector, like Healthcare, Finance, or Retail.

:::tip EXAMPLE
Using tenant attributes, you can enforce policies like:

"Allow access to advanced analytics only for tenants with a Pro or Enterprise subscription."
:::

You can create new tenants via the API, by sending a `POST` request to the following endpoint:

```bash
/v2/facts/{proj_id}/{env_id}/tenants
```

As part of the body, you can send arbitrary tenant attributes that will be used to enforce attribute-based access control
policies.

Here is an example of a `cURL` request that sends the attributes for `allowed_locations`.

```bash
curl https://api.permit.io/v2/facts/my_project/my_environment/tenants \
  --request POST \
  --header 'Authorization: Bearer YOUR_SECRET_TOKEN' \
  --header 'Content-Type: application/json' \
  --data '{
  "key": "stripeinc",
  "name": "Stripe Inc",
  "attributes": {
    "allowed_locations": [
      "US",
      "CA"
    ]
  }
}'
```

:::tip VIA THE UI
As with most data handling in Permit, you can also add tenant attributes to each individual tenant via the no-code UI.

All you have to do in navigate to `Directory` then go to `Settings` and select `Manage Tenants`. Find the tenant you want to
update, click the `three dots` next to it, and choose `Edit Attributes`.

Add or modify attributes as needed, specifying the name and value as a JSON object.

<img
  src="/ui-videos/walkthroughs/sync-data/tenant-attributes.png"
  alt="Tenant Attributes"
  data-zoomable
/>
:::

</TimelineStep>
<TimelineStep>

## Role Assignments (RBAC & ReBAC)

When syncing data into Permit.io, configuring role assignments is a critical step. Role assignments define what actions a user
can perform, either at a global level (RBAC) or in relation to specific resources (ReBAC). Permit supports both models to give
you maximum flexibility.

Role assignments for `top-level` roles or `instance` roles can be defined as extra data in the body of a `POST` request when
creating a new user.

```bash
/v2/facts/{proj_id}/{env_id}/users
```

You can define the top-level roles by specifying the `role` and the `tenant` that role belong in. It will always be an `array`
of roles, as a user can have **more than one role** in **multiple tenants**. Here is an example:

```bash
"roles": [
    {
      "role": "admin",
      "tenant": "company A"
    },
    {
      "role": "viewer",
      "tenant": "company B"
    }
  ]
```

:::tip VIA THE UI
As with most data handling in Permit, you can also add role attributes to each individual role via the no-code UI.

Navigate to `Policy` and then `Roles`, select the specific role you want to add attributes to, click the `three dots` and select
`Edit Attributes`.
:::

We can also define a resource instance role which is associated with each specific resource. This means that if we have a resource
called `Dashboard` and two instances of that resource called `Dashboard A` and `Dashboard B` - then the unique user can have a
resource instance role of `Owner` on `Dashboard A` and resource instance role of `Viewer` on `Dashboard B`.

```bash
"roles": [
    {
      "role": "admin",
      "tenant": "company A",
      "resource_instance": "Dashboard A"
    },
    {
      "role": "viewer",
      "tenant": "company B",
      "resource_instance": "Dashboard B"
    }
  ]
```

</TimelineStep>
<TimelineStep>

## Resource Instances and Resource Instance Attributes (ABAC & ReBAC)

Resource attributes define specific characteristics of a resource, enabling fine-grained and context-aware access control.
These attributes are added when creating a new resource in Permit by specifying them during the setup process. With every attribute,
you have the ability to create individual instances of it. For each individual instance, you can provide extra data as per the defined
attributes.

You can add resource instance attributes when creating a new resource instance, which you will need to send as `POST` request to
the following endpoint:

```bash
/v2/facts/{proj_id}/{env_id}/resource_instances
```

As part of the body of that request, you can send `attributes` keys and their values. Here is an example:

```bash
curl https://api.permit.io/v2/facts/my_project/my_environment/resource_instances \
  --request POST \
  --header 'Authorization: Bearer YOUR_SECRET_TOKEN' \
  --header 'Content-Type: application/json' \
  --data '{
  "key": "react",
  "resource": "repository",
  "tenant": "default",
  "attributes": {
    "private": "false",
    "owner": "Company C"
  }
}'
```

:::tip via the UI

To add resource instance attributes directly from the UI:

You need to navigate to `Directory` and then `Instances`. Select the specific resource instance you want to add attributes for,
click the `three dots` and select `Edit Attributes`.
:::

</TimelineStep>
<TimelineStep>

## Relationship Tuples (ReBAC)

Relationship tuples form the backbone of ReBAC, defining how entities like users, resources, and tenants relate to each other.
These tuples make access control dynamic and contextual.

The format for each relation tuple is as follows:

`<Subject> : <Relation> : <Object>`

:::tip Example Tuples
**user:123 member_of tenant:tenantA**: User 123 is a member of Tenant A.
**user:987 parent_of resource:resourceB**: User 789 owns Resource B.
:::

To create a new relationship tuple, you need to send a `POST` request to the following endpoint:

```bash
/v2/facts/{proj_id}/{env_id}/relationship_tuples
```

As part of this request, you will need to send the `subject`, `relation`, `object` and the `tenant`.

Lets define what these keys mean:

- `subject` - The resource instance assigned the new relation
- `relation`: The relation to assign between the subject and object
- `object`: The resource instance on which the new relation is assigned
- `tenant` - The tenant the subject and object belong to. If the resource instances don't exist yet, the tenant is required to
  create them, otherwise it is ignored.

Here is an example of such a request:

```bash
curl https://api.permit.io/v2/facts/my_project/my_environment/relationship_tuples \
  --request POST \
  --header 'Authorization: Bearer YOUR_SECRET_TOKEN' \
  --header 'Content-Type: application/json' \
  --data '{
  "subject": "organization:permitio",
  "relation": "owner",
  "object": "repo:test",
  "tenant": "public"
}`
```

:::tip VIA THE UI
To configure relationship tuples in the Permit no-code UI:

Navigate to `Directory` and then `Instances`. Select the resource instance you would like to define a tuple for, click the
`three dots` and `Edit Resource Instance`. Define the Subject, Relation, and Object - and proceed to save.
:::

</TimelineStep>
</TimelineWrapper>

:::tip FUN FACT!
Did you know that the concept of data synchronization dates back to the early days of telecommunication?

In the 19th century, synchronization was first used to align clocks for railway systems to prevent train collisions.
:::
